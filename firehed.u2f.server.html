<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>U2F-PHP</title>
        <base href="https://firehed.github.io/u2f-php" />

        <link rel="stylesheet" href="https://firehed.github.io/u2f-php/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://firehed.github.io/u2f-php/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://firehed.github.io/u2f-php/css/highlight.dark.css">
        <link rel="stylesheet" href="https://firehed.github.io/u2f-php/css/main.css">
    </head>
    <body>

        <header class="navbar navbar-default ">

            <a class="navbar-brand" href="https://firehed.github.io/u2f-php/">
                U2F-PHP
                <small class="hidden-xs hidden-sm">
                    Universal Second Factor Authentication
                </small>
            </a>

                            <a href="https://github.com/firehed/u2f-php">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png">
                </a>
            
        </header>

        <main class="container-fluid}">
            <div class="row">
                <nav id="sidebar" class="col-sm-3 col-lg-2" role="navigation">

                    <ul class="nav nav-pills nav-stacked">
                                                    <li class="">
                                <a href="">
                                    Home
                                </a>
                            </li>
                                                    <li class="">
                                <a href="classes.html">
                                    API Overview
                                </a>
                            </li>
                                            </ul>

                </nav>

                <section id="content" class="col-sm-9 col-lg-10">
                    <!-- @generated 2016-04-15T20:02:08+0000 -->
<h1 id="class-firehedu2fserver">class Firehed\U2F\Server</h1>
<h2 id="toc">TOC</h2>
<ul>
<li><a href="#definition">Definition</a></li>
<li><a href="#public-method-summary">Public Summary</a></li>
<li><a href="#methods">Methods</a></li>
</ul>
<h2 id="definition">Definition</h2>
<p>Defined in /Users/firehed/dev/u2f/src/Server.php</p>
<h2 id="public-method-summary">Public Method Summary</h2>
<p>function authenticate(<a href="Firehed.U2F.SignResponse.html">Firehed\U2F\SignResponse</a> $response): <a href="Firehed.U2F.Registration.html">Firehed\U2F\Registration</a></p>
<p>function disableCAVerification(): <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a></p>
<p>function generateRegisterRequest(): <a href="Firehed.U2F.RegisterRequest.html">Firehed\U2F\RegisterRequest</a></p>
<p>function generateSignRequest(<a href="Firehed.U2F.Registration.html">Firehed\U2F\Registration</a> $reg): <a href="Firehed.U2F.SignRequest.html">Firehed\U2F\SignRequest</a></p>
<p>function generateSignRequests(array $registrations): array</p>
<p>function getAppId(): string</p>
<p>function getApplicationParameter(): string</p>
<p>function register(<a href="Firehed.U2F.RegisterResponse.html">Firehed\U2F\RegisterResponse</a> $resp): <a href="Firehed.U2F.Registration.html">Firehed\U2F\Registration</a></p>
<p>function setAppId(string $appId): <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a></p>
<p>function setRegisterRequest(<a href="Firehed.U2F.RegisterRequest.html">Firehed\U2F\RegisterRequest</a> $request): <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a></p>
<p>function setRegistrations(array $registrations): <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a></p>
<p>function setSignRequests(array $signRequests): <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a></p>
<p>function setTrustedCAs(array $CAs): <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a></p>
<h2 id="constants">Constants</h2>
<p>None</p>
<h2 id="methods">Methods</h2>
<hr />
<h3 id="public--function-authenticate">public  function authenticate</h3>
<p>This method authenticates a <code>SignResponse</code> against outstanding
<code>Registrations</code> and their corresponding <code>SignRequest</code>s. If the
response's signature validates and the counter hasn't done anything
strange, the Registration will be returned with an updated counter
value, which <em>must</em> be persisted for the next authentication. If any
verification component fails, a <code>SE</code> will be thrown.</p>
<p>Parameters:</p>
<ul>
<li><a href="Firehed.U2F.SignResponse.html">Firehed\U2F\SignResponse</a> $response -- the parsed response from the user</li>
</ul>
<p>Throws :</p>
<ul>
<li>SE -- if authentication fails</li>
<li><a href="https://php.net/BadMethodCallException">BadMethodCallException</a> -- if a precondition is not met</li>
</ul>
<p>Returns: <a href="Firehed.U2F.Registration.html">Firehed\U2F\Registration</a> if authentication succeeds</p>
<hr />
<h3 id="public--function-disablecaverification">public  function disableCAVerification</h3>
<p>Disables verification of the Attestation Certificate against the list of
CA certificates. This lowers overall security, at the benefit of being
able to use devices that haven't been explicitly whitelisted.</p>
<p>This method or setTrustedCAs() must be called before register() or
a SecurityException will always be thrown.</p>
<p>Parameters:</p>
<p>None</p>
<p>Returns: <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a> </p>
<hr />
<h3 id="private--function-findobjectwithkeyhandle">private  function findObjectWithKeyHandle</h3>
<p>Searches through the provided array of objects, and looks for a matching
key handle value. If one is found, it is returned; if not, this returns
null.</p>
<p>Parameters:</p>
<ul>
<li>
<p>array $objects -- haystack to search</p>
</li>
<li>string $keyHandle -- key handle to find in haystack</li>
</ul>
<p>Returns: TODO TRY TO INFER FROM DOCBLOCK element from haystack</p>
<hr />
<h3 id="private--function-generatechallenge">private  function generateChallenge</h3>
<p>Generates a random challenge and returns it base64-web-encoded</p>
<p>Parameters:</p>
<p>None</p>
<p>Returns: string </p>
<hr />
<h3 id="public--function-generateregisterrequest">public  function generateRegisterRequest</h3>
<p>Creates a new RegisterRequest to be sent to the authenticated user to be
used by the <code>u2f.register</code> API.</p>
<p>Parameters:</p>
<p>None</p>
<p>Returns: <a href="Firehed.U2F.RegisterRequest.html">Firehed\U2F\RegisterRequest</a> </p>
<hr />
<h3 id="public--function-generatesignrequest">public  function generateSignRequest</h3>
<p>Creates a new SignRequest for an existing Registration for an
authenticating user, used by the <code>u2f.sign</code> API.</p>
<p>Parameters:</p>
<ul>
<li><a href="Firehed.U2F.Registration.html">Firehed\U2F\Registration</a> $reg -- one of the user's existing Registrations</li>
</ul>
<p>Returns: <a href="Firehed.U2F.SignRequest.html">Firehed\U2F\SignRequest</a> </p>
<hr />
<h3 id="public--function-generatesignrequests">public  function generateSignRequests</h3>
<p>Wraps generateSignRequest for multiple Registrations</p>
<p>Parameters:</p>
<ul>
<li>array $registrations</li>
</ul>
<p>Returns: array </p>
<hr />
<h3 id="public--function-getappid">public  function getAppId</h3>
<p>Parameters:</p>
<p>None</p>
<p>Returns: string </p>
<hr />
<h3 id="public--function-getapplicationparameter">public  function getApplicationParameter</h3>
<p>Parameters:</p>
<p>None</p>
<p>Returns: string raw SHA-256 hash of the App ID</p>
<hr />
<h3 id="public--function-register">public  function register</h3>
<p>This method authenticates a RegisterResponse against its corresponding
RegisterRequest by verifying the certificate and signature. If valid, it
returns a Registration object; if not, a SE will be
thrown and attempt to register the key must be aborted.</p>
<p>Parameters:</p>
<ul>
<li><a href="Firehed.U2F.RegisterResponse.html">Firehed\U2F\RegisterResponse</a> $resp -- response to verify</li>
</ul>
<p>Throws :</p>
<ul>
<li>SE -- if the response cannot be proven authentic</li>
<li><a href="https://php.net/BadMethodCallException">BadMethodCallException</a> -- if a precondition is not met</li>
</ul>
<p>Returns: <a href="Firehed.U2F.Registration.html">Firehed\U2F\Registration</a> if the response is proven authentic</p>
<hr />
<h3 id="public--function-setappid">public  function setAppId</h3>
<p>Parameters:</p>
<ul>
<li>string $appId</li>
</ul>
<p>Returns: <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a> </p>
<hr />
<h3 id="public--function-setregisterrequest">public  function setRegisterRequest</h3>
<p>Provide the previously-generated RegisterRequest to be used when
verifying a RegisterResponse during register()</p>
<p>Parameters:</p>
<ul>
<li><a href="Firehed.U2F.RegisterRequest.html">Firehed\U2F\RegisterRequest</a> $request</li>
</ul>
<p>Returns: <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a> </p>
<hr />
<h3 id="public--function-setregistrations">public  function setRegistrations</h3>
<p>Provide a user's existing Registrations to be used during authentication</p>
<p>Parameters:</p>
<ul>
<li>array $registrations</li>
</ul>
<p>Returns: <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a> </p>
<hr />
<h3 id="public--function-setsignrequests">public  function setSignRequests</h3>
<p>Provide the previously-generated SignRequests, corresponing to the
existing Registrations, of of which should be signed and will be
verified during authenticate()</p>
<p>Parameters:</p>
<ul>
<li>array $signRequests</li>
</ul>
<p>Returns: <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a> </p>
<hr />
<h3 id="public--function-settrustedcas">public  function setTrustedCAs</h3>
<p>Provides a list of CA certificates for device issuer verification during
registration.</p>
<p>This method or disableCAVerification must be called before register() or
a SecurityException will always be thrown.</p>
<p>Parameters:</p>
<ul>
<li>array $CAs -- A list of file paths to device issuer CA certs</li>
</ul>
<p>Returns: <a href="Firehed.U2F.Server.html">Firehed\U2F\Server</a> </p>
<hr />
<h3 id="private--function-validatechallenge">private  function validateChallenge</h3>
<p>Compares the Challenge value from a known source against the
user-provided value. A mismatch will throw a SE. Future
versions may also enforce a timing window.</p>
<p>Parameters:</p>
<ul>
<li>
<p><a href="Firehed.U2F.ChallengeProvider.html">Firehed\U2F\ChallengeProvider</a> $from -- source of known challenge</p>
</li>
<li><a href="Firehed.U2F.ChallengeProvider.html">Firehed\U2F\ChallengeProvider</a> $to -- user-provided value</li>
</ul>
<p>Throws :</p>
<ul>
<li>SE -- on failure</li>
</ul>
<p>Returns: bool on success</p>
                </section>

            </div>
        </main>

        <footer>
            <div class="container-fluid">
                <p class="text-muted">
                    website generated with <a href="http://couscous.io" title="Markdown website generator">Couscous</a>
                </p>
            </div>
        </footer>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="//yastatic.net/highlightjs/8.2/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

    </body>
</html>
