<?php

$hex = 
    'a363666d74656170706c656761747453746d74a1637835638259024730820243'.
    '308201c9a0030201020206017cc48b0c12300a06082a8648ce3d040302304831'.
    '1c301a06035504030c134170706c6520576562417574686e2043412031311330'.
    '11060355040a0c0a4170706c6520496e632e3113301106035504080c0a43616c'.
    '69666f726e6961301e170d3231313032373031333635395a170d323131303330'.
    '3031333635395a3081913149304706035504030c406438613864613562346134'.
    '6263373166613434383831636365353239643661653265313861623139353334'.
    '646333373333383130626136396335633433316330311a3018060355040b0c11'.
    '4141412043657274696669636174696f6e31133011060355040a0c0a4170706c'.
    '6520496e632e3113301106035504080c0a43616c69666f726e69613059301306'.
    '072a8648ce3d020106082a8648ce3d0301070342000459130b4f9f10cede00f0'.
    '8b887386cea69c91c582290d5a20fe38031026846336243ae2ff6cf36981a23b'.
    'c69f9f9625cdfc7da7d19b8a35c32385e24b82cc49dea3553053300c0603551d'.
    '130101ff04023000300e0603551d0f0101ff0404030204f0303306092a864886'.
    'f76364080204263024a1220420feec4857016348743dc41ca054179b2245ad42'.
    '9bd35e61b3e554bfdcfd8a9a99300a06082a8648ce3d04030203680030650230'.
    '14444af6d42a1e3dfee2d48f3659eb6a2cbfd8910a94736a4dae08067bf7799e'.
    '9a4690a4dfbfe5e5f910f60cb88bee74023100812455de54a25101ac8b4c6269'.
    'c2f1201342964ee9e67d5ace18bc89000823cb261eb5c7d26a932bc63d7465b7'.
    'c8f07d59023830820234308201baa003020102021056255395c7a7fb40ebe228'.
    'd8260853b6300a06082a8648ce3d040303304b311f301d06035504030c164170'.
    '706c6520576562417574686e20526f6f7420434131133011060355040a0c0a41'.
    '70706c6520496e632e3113301106035504080c0a43616c69666f726e6961301e'.
    '170d3230303331383138333830315a170d3330303331333030303030305a3048'.
    '311c301a06035504030c134170706c6520576562417574686e20434120313113'.
    '3011060355040a0c0a4170706c6520496e632e3113301106035504080c0a4361'.
    '6c69666f726e69613076301006072a8648ce3d020106052b8104002203620004'.
    '832e872f261491810225b9f5fcd6bb6378b5f55f3fcb045bc735993475fd5490'.
    '44df9bfe19211765c69a1dda050b38d45083401a434fb24d112d56c3e1cfbfcb'.
    '9891fec0696081bef96cbc77c88dddaf46a5aee1dd515b5afaab93be9c0b2691'.
    'a366306430120603551d130101ff040830060101ff020100301f0603551d2304'.
    '183016801426d764d9c578c25a67d1a7de6b12d01b63f1c6d7301d0603551d0e'.
    '04160414ebae82c4ffa1ac5b51d4cf24610500be63bd7788300e0603551d0f01'.
    '01ff040403020106300a06082a8648ce3d0403030368003065023100dd8b1a34'.
    '81a5fad9dbb4e7657b841e144c27b75b876a4186c2b1475750337227efe55445'.
    '7ef648950c632e5c483e70c102302c8a6044dc201fcfe59bc34d2930c1487851'.
    'd960ed6a75f1eb4acabe38cd25b897d0c805bef0c7f78b07a571c6e80e076861'.
    '75746844617461589849960de5880e8c687434170f6476605b8fe4aeb9a28632'.
    'c7995cf3ba831d97634500000000f24a8e70d0d3f82c293732523cc4de5a0014'.
    'dd25a8525669d82738bb1a3a19992c57eeefb2b4a50102032620012158205913'.
    '0b4f9f10cede00f08b887386cea69c91c582290d5a20fe380310268463362258'.
    '20243ae2ff6cf36981a23bc69f9f9625cdfc7da7d19b8a35c32385e24b82cc49'.
    'de';

require 'vendor/autoload.php';

$bin = hex2bin($hex);

$decoder = new Firehed\CBOR\Decoder();
/**
 * @var array{
 * fmt: string,
 * attStmt: array,
 * authData: string,
 * }
 */
$data = $decoder->decode($bin);

var_dump("fmt = {$data['fmt']}");
$authData = Firehed\U2F\WebAuthn\AuthenticatorData::parse($data['authData']);
print_R($authData);
var_dump(array_keys($data));

var_dump("attStmt");
$attStmt = $data['attStmt'];
var_dump(array_keys($attStmt));
$x5c = $attStmt['x5c'];
foreach ($x5c as $k => $v) {
    var_dump("$k = " . gettype($v));
    $cert = new Firehed\U2F\AttestationCertificate($v);
    print_r($cert->getPemFormatted());
}
